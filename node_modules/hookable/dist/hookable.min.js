!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):(e=e||self).hookable=o()}(this,(function(){"use strict";function e(o){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(o)}function o(e,o,t,n,r,i,s){try{var a=e[i](s),u=a.value}catch(e){return void t(e)}a.done?o(u):Promise.resolve(u).then(n,r)}function t(e,o){if(!(e instanceof o))throw new TypeError("Cannot call a class as a function")}function n(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function r(o){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0;for(var i in o){var s=o[i],a=n?"".concat(n,":").concat(i):i;"object"===e(s)&&null!==s?r(s,t,a):t[a]=s}return t}function i(e,o){return e.reduce((function(e,t){return e.then((function(){return o(t)}))}),Promise.resolve(null))}return function(){function e(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:console;t(this,e),this._logger=o,this._hooks={},this._deprecatedHooks={},this.hook=this.hook.bind(this),this.callHook=this.callHook.bind(this)}var s,a,u,c,h;return s=e,(a=[{key:"hook",value:function(e,o){var t=this;if(!e||"function"!=typeof o)return function(){};for(var n,r=e;this._deprecatedHooks[e];)"string"==typeof(n=this._deprecatedHooks[e])&&(n={to:n}),e=n.to;return n&&this._logger&&(n.message?this._logger.warn(n.message):this._logger.warn("".concat(r," hook has been deprecated")+(n.to?", please use ".concat(n.to):""))),this._hooks[e]=this._hooks[e]||[],this._hooks[e].push(o),function(){o&&(t.removeHook(e,o),o=null)}}},{key:"removeHook",value:function(e,o){if(this._hooks[e]){var t=this._hooks[e].indexOf(o);-1!==t&&this._hooks[e].splice(t,1),0===this._hooks[e].length&&delete this._hooks[e]}}},{key:"deprecateHook",value:function(e,o){this._deprecatedHooks[e]=o}},{key:"deprecateHooks",value:function(e){Object.assign(this._deprecatedHooks,e)}},{key:"addHooks",value:function(e){var o=this,t=r(e),n=Object.keys(t).map((function(e){return o.hook(e,t[e])}));return function(){n.splice(0,n.length).forEach((function(e){return e()}))}}},{key:"removeHooks",value:function(e){var o=r(e);for(var t in o)this.removeHook(t,o[t])}},{key:"callHook",value:(c=regeneratorRuntime.mark((function e(o){var t,n,r,s=arguments;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=s.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=s[r];if(this._hooks[o]){e.next=3;break}return e.abrupt("return");case 3:return e.prev=3,e.next=6,i(this._hooks[o],(function(e){return e.apply(void 0,n)}));case 6:e.next=14;break;case 8:if(e.prev=8,e.t0=e.catch(3),"error"===o){e.next=13;break}return e.next=13,this.callHook("error",e.t0);case 13:this._logger&&(this._logger.fatal?this._logger.fatal(e.t0):this._logger.error(e.t0));case 14:case"end":return e.stop()}}),e,this,[[3,8]])})),h=function(){var e=this,t=arguments;return new Promise((function(n,r){var i=c.apply(e,t);function s(e){o(i,n,r,s,a,"next",e)}function a(e){o(i,n,r,s,a,"throw",e)}s(void 0)}))},function(e){return h.apply(this,arguments)})}])&&n(s.prototype,a),u&&n(s,u),e}()}));
